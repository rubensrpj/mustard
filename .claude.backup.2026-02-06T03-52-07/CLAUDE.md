# mustard-claude - Instructions for Claude

> Auto-generated by **Mustard CLI v2.0**

Type: **single**
Package Manager: **npm**

---

## 1. Quick Reference

```
Entities:     PascalCase singular     ‚Üí Contract, Person, Company
DB Tables:    snake_case plural       ‚Üí contracts, people, companies
Endpoints:    /api/kebab-case         ‚Üí /api/contracts, /api/people
Components:   PascalCase.tsx          ‚Üí ContractForm.tsx
Hooks:        use + camelCase         ‚Üí useContracts.ts
```

### Detected Conventions

| Type | Pattern |
|------|---------|
| Classes | PascalCase |
| Files | {"ts":"camelCase","tsx":"camelCase"} |
| Folders | plural |

---

## 2. Project State

| Project | Technology | Port | Status |
|---------|------------|------|--------|
| . | node unknown | - | ‚úÖ Detected |

---

## 3. DELEGATION VIA TASK TOOL

> üí° **RECOMMENDED:** Use Task tool to delegate tasks to specialized agents.

### Available Agents

| Agent | Usage | Model |
|-------|-------|-------|
| `Explore` | Explore codebase, find files | haiku |
| `Plan` | Plan complex implementations | sonnet |
| `general-purpose` | Implement code, bug fixes | opus/sonnet |
| `Bash` | Execute terminal commands | - |

### Delegation Map

| Request | Agent | Model |
|---------|-------|-------|
| Bug fix | `general-purpose` | opus |
| New feature | `Plan` ‚Üí `general-purpose` | sonnet/opus |
| Explore code | `Explore` | haiku |
| Backend/Frontend/DB | `general-purpose` | opus |

---

## 4. Available Commands

### Pipeline

| Command | Description |
|---------|-------------|
| `/feature <name>` | **Single entry point for features** - Starts full pipeline |
| `/bugfix <error>` | **Single entry point for bugs** - Diagnosis + fix |
| `/approve` | Approve spec and start implementation |
| `/complete` | Finalize pipeline |
| `/resume` | Resume active pipeline |

### Git

| Command | Description |
|---------|-------------|
| `/commit` | Simple commit |
| `/commit-push` | Commit and push |
| `/merge-main` | Merge to main |

### Validation

| Command | Description |
|---------|-------------|
| `/validate` | Build + type-check |
| `/status` | Consolidated status |

### Sync

| Command | Description |
|---------|-------------|
| `/sync-registry` | Update Entity Registry |
| `/install-deps` | Install dependencies |
| `/sync-context` | Load project context |

### Task Commands (L0 Universal Delegation)

| Command | Emoji | Description |
|---------|-------|-------------|
| `/task-analyze <scope>` | üîç | Code analysis via Task(Explore) |
| `/task-review <scope>` | üîé | Code review via Task(general-purpose) |
| `/task-refactor <scope>` | üìã‚öôÔ∏è | Refactoring via Task(Plan) ‚Üí Task(general-purpose) |
| `/task-docs <scope>` | üìä | Documentation via Task(general-purpose) |

> **CRITICAL:** These commands ensure ALL code activities are delegated to a separate context (Task), keeping the parent context clean.

---

## 5. Single Pipeline

```
/feature or /bugfix
         ‚îÇ
         ‚ñº
    EXPLORE (Task Explore)
         ‚îÇ
         ‚ñº
      SPEC (spec/active/{name}/spec.md)
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚ñº         ‚ñº
[APPROVED]  [ITERATE]
    ‚îÇ         ‚îÇ
    ‚ñº    (back)
IMPLEMENT (Task general-purpose)
    ‚îÇ
    ‚ñº
  REVIEW
    ‚îÇ
    ‚ñº
COMPLETED
```

---

## 6. Entity Registry (REQUIRED)

**CRITICAL RULE**: Before searching for ANY entity files,
ALWAYS read `.claude/entity-registry.json` first.

### Format

```json
{
  "_meta": { "version": "2.1" },
  "_p": {},
  "e": {
    "Entity1": 1,
    "Entity2": 1
  }
}
```

Paths are derived from `_p` (patterns) + entity name.

---

## 7. grepai - Semantic Search

Use grepai as the preferred tool for code search:

```javascript
// Semantic search
grepai_search({ query: "authentication flow" })

// Call tracing
grepai_trace_callers({ symbol: "SaveContract" })
grepai_trace_callees({ symbol: "ValidatePayment" })
```

### Search Rules

| Tool | Recommendation |
|------|----------------|
| `grepai_search` | ‚úÖ Prefer for semantic search |
| `grepai_trace_*` | ‚úÖ Use to understand dependencies |
| `Grep` | ‚ö†Ô∏è Use only if grepai is unavailable |
| `Glob` | ‚ö†Ô∏è Use for specific file patterns |

---

## 8. Rules

### Enforcement Rules

| Level | Rule | Description |
|-------|------|-------------|
| L0 | Universal Delegation | ALL code activities MUST be delegated via Task (separate context) |
| L1 | grepai | Prefer grepai for semantic search |
| L2 | Pipeline | Pipeline required for features/bugs |
| L3 | Patterns | Follow naming conventions |

### Project Rules

- Follow project naming conventions
- Use dependency injection
- Keep code testable and modular
- Document public APIs

---

## 9. Links

### Core
- [Enforcement](./core/enforcement.md)
- [Naming Conventions](./core/naming-conventions.md)
- [Pipeline](./core/pipeline.md)

### Commands
- [Mustard Commands](./commands/mustard/) - Core commands (managed by Mustard)
- [User Commands](./commands/) - Custom commands (preserved on updates)

### Prompts
- [Prompts Index](./prompts/_index.md)

### Hooks
- [enforce-pipeline.js](./hooks/enforce-pipeline.js)